---
title: Routes
---

import { Tabs, TabItem, FileTree } from '@astrojs/starlight/components';

You can create a route by adding a request handler to the server using
`.WithRequestHandler()`.

```go
//main.go
package main

import (
    "embed"
    "github.com/razshare/frizzante"
    "main/lib/api"
    "main/lib/notifiers"
)

//go:embed .dist/*/**
var dist embed.FS
var server = frizzante.NewServer().
    WithNotifier(notifiers.Console).
    WithAddress("127.0.0.1:8080").
    WithRequestHandler("GET /", routes.GetHandler)    // <=== Adds handler.

func main() {
    server.Start(dist)
}
```

Generally speaking your request handlers should be 
located under `lib/routes`, so in this example, `routes.GetHandler` 
is located in `lib/routes/handler.go`.

```go
//lib/routes/handler.go
package routes

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    res.SendMessage("Hello")
}
```

## Status

Use `res.SendStatus()` to send the status of the response.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    res.SendStatus(404)                             // Sends status 404.
    res.SendMessage("Resource not found, sorry.")   // Sends text.
}
```

:::danger
The order in which data is sent to the client matters. <br/>
Read more about [order of operations](#order-of-operations).
:::


## Header

Use `req.ReceiveHead()` to retrieve header fields and `res.SendHeader()` to send them.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    ctype := req.ReceiveHeader("Content-Type")  // Retrieves field "Content-Type".
    res.SendHeader("Content-Type", ctype)       // Sends it back.
}
```

:::danger
The order in which data is sent to the client matters. <br/>
Read more about [order of operations](#order-of-operations).
:::

## Path

Request handlers can define dynamic fields within the pattern using `{}` syntax,
which you can retrieve with `req.ReceivePath()`.

```go
//main.go
var server = frizzante.NewServer().
    //...
    WithRequestHandler("GET /{name}", routes.GetHello)
    //...
```

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    name := req.ReceivePath("name")     // Retrieves field "name".
    res.SendMessage("Hello " + name)    // Sends text.
}
```

## Query

Use `req.ReceiveQuery()` to retrieve query fields.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    name := req.ReceiveQuery("name")    // Retrieves field "name".
    res.SendMessage("Hello " + name)    // Sends text.
}
```

## Forms

Use `req.ReceiveForm()` to retrieve and parse forms
when using `POST` and `PUT` http verbs.

```go
//main.go
var server = frizzante.NewServer().
    //...
    WithRequestHandler("POST /", routes.PostHello)
    //...
```

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func PostHello(req *frizzante.Request, res *frizzante.Response) {
    form := req.ReceiveForm()           // Retrieves and parses the form.
    name := form.Get("name")            // Retrieves field "name".
    res.SendMessage("Hello " + name)    // Sends text.
}

```

## Json

Use `req.ReceiveJson()` to parse incoming content as json and `req.SendJson()` to send data as json when using `POST` and `PUT` http verbs.

```go
//main.go
var server = frizzante.NewServer().
    //...
    WithRequestHandler("POST /", routes.PostHello)
    //...
```

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

type GreetingDetails struct {
    Name string `json:"name"`
}

func PostHello(req *frizzante.Request, res *frizzante.Response) {
    var value *GreetingDetails  // Prepares empty value.
    req.ReceiveJson(value)      // Parses the content into value.
    res.SendJson(value)         // Sends it back.
}
```

## Cookies

Use `req.ReceiveCookie()` to retrieve cookies and `res.SendCookie()` to send them.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    cookie := req.ReceiveCookie("session-id")   // Retrieves cookie "session-id".
    res.SendCookie("session-id", cookie)        // Sends it back.
}
```

## Redirect

Use `res.SendRedirect()` to redirect to a different location.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    res.SendRedirect("/login", 302)
}
```

## Navigate

Use `res.SendNavigate()` to redirect to a different location with status `302`.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    res.SendNavigate("/login")
}
```

## Server Sent Events

Use `res.SendSseUpgrade()` to upgrade the connection to server sent events.

```go
//lib/routes/handler.go
package lib

import (
    "github.com/razshare/frizzante"
    "time"
)

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    alive := req.IsAlive()          // Track request status.
    ev := res.SendSseUpgrade()      // Send sse upgrade.
    for *alive {                    // Loop until request gets cancelled.
        ev("channel-1")             // Switch to event "channel-1".
        res.SendMessage("hello 1")  // Send text.
        ev("channel-2")             // Switch to event "channel-1".
        res.SendMessage("hello 2")  // Send text.
        time.Sleep(time.Second)     // Sleep for 1 second.
    }
}
```

## Web Sockets

Use `res.SendWsUpgrade()` to upgrade the connection to web sockets.

```go
//lib/routes/handler.go
package lib

import (
    "github.com/razshare/frizzante"
    "time"
)

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    alive := req.IsAlive()          // Track request status.
    res.SendWsUpgrade()             // Send ws upgrade.
    for *alive {                    // Loop until request gets cancelled.
        ev("channel-1")             // Switch to event "channel-1".
        res.SendMessage("hello 1")  // Send text.
        ev("channel-2")             // Switch to event "channel-1".
        res.SendMessage("hello 2")  // Send text.
        time.Sleep(time.Second)     // Sleep for 1 second.
    }
}
```

## Order of Operations

Order of operations matters when sending data to the client.

**Status codes** must be sent **before headers**, which must be sent **before content**.

:::danger
For example, sending the status code with `res.SendStatus()` **after** you've already sent content
with `res.SendMessage()` is not allowed.

```go
//lib/routes/handler.go
package lib

import "github.com/razshare/frizzante"

func GetHandler(req *frizzante.Request, res *frizzante.Response) {
    res.SendMessage("Hello.")   // Sending text.    (Will Succeed)
    res.SendStatus(404)         // Sending status.  (Will Fail)
}
```

The request handler will continue execution and the user will receive the response correctly

```http
HTTP/1.1 200 OK
Date: Sun, 25 May 2025 02:00:37 GMT
Content-Length: 6
Content-Type: text/plain; charset=utf-8

Hello.
```

But `res.SendStatus()` will fail and send an error to 
the server notifier.

Assuming you're using the default notifier, you'll see and error of sorts in your console

```sh
listening for requests at http://127.0.0.1:8080
status is locked
```

`status is locked`, meaning the status code has already been sent to the client and there's nothing you can do about it.
:::